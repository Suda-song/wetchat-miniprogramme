# wetchat-miniprogramme
技术开发方案
整体设计
小程序主要含三个页面，分别是个人界面、资料汇总、答疑互助。除了个人界面中可以访问收藏过的资料汇总页面，三个模块相对独立。互相独立的模块的设计使小组分工合作开发的效率提高。
功能开发
个人界面模块
该模块主要包含“书架”、“已购”、“客服”、“活动广场”几个部分。
书架
用户收藏的页面将被存储于云数据库中。当用户点击进入“书架”页面时，小程序将从云数据库中加载用户收藏的内容并进行显示。
已购（待开发）
客服
当用户对小程序有任何反馈时，可以通过客服页面向小程序运营团队进行反馈。客服聊天窗口的核心实现方法是将open-type设置为contact。
活动广场（待开发）
资料汇总模块
数据储存方式
该模块提供了根据课程性质分类查看的功能，因此在该模块中，数组被用于存储各个分类的课程数据。另外，每个课程的简介、相关资料的数据都存于该课程对应页面的js文件中。
相关操作的实现
当用户选择某一分类时，小程序通过选定分类对应的数字从数组中加载该分类下对应的课程的数据。当用户选择某一课程时，小程序将通过navigator组件跳转至该课程对应的页面。在课程对应的页面中，使用云数据库记录收藏信息。需要下载文件时，通过微信提供的downloadFile对文件进行下载。
答疑互助模块
云函数
由于问题与回答都储存于云数据库中，而普通用户只能通过云函数操作云数据库，因此，该项目使用云函数实现添加问题与回答的功能。
数据储存方式
该模块涉及到的数据，包括学院、课程、问题、回答，都储存在云数据库中的两个集合中，其中一个集合用于存放学院以及该学院开设的课程的数据，另一个集合用于存放问题与回答的数据。在存放学院与课程的数据的集合中，每一条记录对应一个学院，该纪录中存放一个对象数组，每个对象含有课程名称以及该课程在另一集合中对应的记录的id；在存放问题与回答的数据的集合中，每一条记录对应一门课程，该纪录中存放一个对象数组，每个对象对应一个问题，含有问题的字符串与一个字符串数组，存放该问题下的回答。
相关操作的实现
当用户添加问题时，小程序将创建一个新的对象，储存问题对应的字符串以及一个未来用于储存回答的空数组，接着将该对象推入（push）该课程的对象数组，并在云数据库中更新，同时更新视图层。当用户添加回答时，小程序将从云数据库中该课程的对象数组中搜索该问题对应的对象，将新回答推入该对象的字符串数组，并在云数据库中更新，同时更新视图层。
最终成果
小程序能够实现预期的功能和效果。
个人界面
 
资料汇总
    
答疑互助
    
现存问题
尽管该项目的完成度较高，但实际上还存在一些问题，以及可以完善的方面。
个人界面模块
潜在问题
•	客服功能不完善
 	在该项目中，客服相关工作需要专人负责，增加了运营团队的人力资源负担。
•	部分功能有待完善
 	在该项目中，个人主页显示的“活动广场”等功能尚未开发，“已购”与“收藏”存在潜在的耦合。
改进方向
•	增添自动化服务
 	根据如上“客服功能不完善”的问题，未来可以增添客服机器人，实现部分客服工作的自动化，减轻运营团队的负担。
•	完善相关功能
 	根据如上“部分功能有待完善”的问题，未来可以继续完善相关功能，或删除冗余功能。
资料汇总模块
潜在问题
•	代码冗余
 	在项目代码文件中，每个课程都有对应的页面文件，形成了大量的冗余。由于每个课程页面的结构完全相同，理论上只需要一个可复用的页面文件即可实现理想的功能。
•	“硬编码”
 	在该项目中，课程相关文件均采用了“硬编码”的方式，导致了未来修改的难度大大增加。理论上说，通过“软编码”的方式编程不仅可以使未来的修改难度明显减少，还可以实现代码的精简。
•	收藏功能有较大缺陷
 	在该项目中，不同用户无法进行个性化的收藏，所有用户收藏的页面都将被没有区别地添加到云数据库中。
改进方向
•	实现页面的可复用性
 	根据如上“代码冗余”的问题，未来可以从页面可复用性的方向改进。首先，可以将每个课程页面的结构抽象出来，接着，将目前代码文件中的所有课程页面的信息抽取出来，储存在json文件或云数据库中。通过这个改进方法，用户在点击具体课程时，小程序可以通过从json文件或云数据库中载入数据，再通过页面传值的方式，显示出具体课程的相关信息。
•	“软编码”
 	根据如上“硬编码”的问题，未来可以从“软编码”的方向改进。对于“电子书”、“习题解析”以及“历年真题”，可以直接将相关文件的链接储存在json文件或云数据库中，其中“电子书”、“习题解析”、“历年真题”分别对应一个数组，数组中，每一个文件对应一个对象，对象包含了文件名以及文件链接。通过这样的方式，未来对文件进行修改时，只需要对数组进行修改，不需要更改相关页面文件。
•	更改收藏逻辑
 	根据如上“收藏功能有较大缺陷”的问题，未来可以从更改收藏逻辑的方向改进。在云数据库中，每个用户应对应一条记录（record），其收藏的页面应存储于该记录下的数组中。
答疑互助模块
潜在问题
•	时间复杂度高
 	在该项目中，为问题添加回答的程序的时间复杂度较高。程序中，问题与回答的数据储存于云数据库中，用户通过云函数为某一问题添加问题时，程序需要通过线性搜索的方式从云数据库中找到对应的问题。当问题数量较多时，线性搜索需要的时间也较长。
•	刷新功能不完善
 	在该项目中，当用户添加问题或回答时，其他用户无法通过下拉刷新来浏览新添加的内容，只能通过重新加载小程序实现。在实际使用中，该问题严重影响用户体验。
•	缺乏多媒体支持
 	在该项目中，用户只能添加文字问题与回答。由于许多课程的性质，含有图像或视频的问题与回答较为普遍，因此，用户对添加多媒体问题与回答的需求较为旺盛。因此，问题与回答缺少多媒体格式是一个较大的问题。
•	页面设置不合理
 	在该项目中，所有课程的问题与回答都集中在一个页面，且当选中某一特定课程时，该课程下所有问题与每个问题的回答都将显示。因此，该页面显示了过多的内容，给用户造成了较为不良的体验。
•	缺少搜索功能
 	在该项目中，当课程较多，或课程下的问题的数目较为巨大时，用户需要自行搜索，浪费了用户大量的时间。该小程序的初衷是节省用户获取信息的时间，因此搜索功能的缺少与小程序的初衷背离，严重削弱了该小程序的竞争力。
改进方向
•	改进数据结构与算法
 	根据如上“时间复杂度高”的问题，未来可以通过更改课程、问题以及回答的存储数据结构，并更新添加问题与回答的算法。一种潜在的方案是放弃用数组储存问题并在每个问题中用数组储存回答的方案，将每一个问题作为云数据库的一条记录（record）进行储存，并把该问题下的回答直接储存于该记录的数组中，避免“数组套数组”的储存方式。
•	改进页面显示逻辑
 	根据如上“刷新功能不完善”与“页面设置不合理”的问题，未来可以更改页面显示逻辑，使信息精简地表达，同时使每一次刷新都能使新添加到云数据库的问题与回答得到显示。
•	增添多媒体支持
 	根据如上“缺乏多媒体支持”的问题，未来可以为添加问题与添加回答的页面文件中增添上传图片、视频等多媒体格式的功能，可以直接通过接口实现。
•	添加搜索功能
 	根据如上“缺少搜索功能”的问题，未来可以为小程序添加模糊搜功能，使用户可以方便地搜索课程、问题以及回答。
